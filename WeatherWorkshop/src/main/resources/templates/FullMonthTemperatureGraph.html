<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Full Month Temperature - Scala Weather Workshop</title>
    
    <script th:inline="javascript">
/*<![CDATA[*/

    var month = [[${month}]];
    var year = [[${year}]];

/*]]>*/
	</script>
    
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <script type="text/javascript">
      google.charts.load('current', {'packages':['corechart']});
      google.charts.setOnLoadCallback(drawChart);

	  function http_get(url) {
		var xhttp ;
		xhttp = new XMLHttpRequest();
		xhttp.open("GET", url, false);	// does not work with async=true
		xhttp.send();
		var x = xhttp.responseText;
		return eval(x) ;
		// folowing line is result of a Scala program working on data of June 2016, retrieved from ims site
		//var data1 = google.visualization.arrayToDataTable([['Date', 'Min Temperature', 'Max Temperature'],[1, 20.7, 34.8],[2, 20.2, 33.4],[3, 21.7, 39.1],[4, 26.9, 41.5],[5, 20.8, 35.6],[6, 19.3, 32.2],[7, 21.1, 35.4],[8, 20.5, 37.6],[9, 18.9, 28.6],[10, 13.2, 28.5],[11, 17.3, 29.2],[12, 17.2, 31.5],[13, 21.4, 37.4],[14, 20.2, 37.4],[15, 20.6, 35.9],[16, 19.3, 30.3],[17, 19.8, 31.9],[18, 20.0, 34.0],[19, 19.5, 35.7],[20, 22.4, 38.0],[21, 23.9, 37.2],[22, 22.6, 35.9],[23, 21.8, 35.9],[24, 22.1, 36.0],[25, 22.2, 36.8],[26, 20.5, 35.0],[27, 22.3, 33.3],[28, 21.0, 31.2],[29, 22.6, 33.0],[30, 21.6, 33.2] ]);
	  }
	  
      function drawChart() {
        var data = google.visualization.arrayToDataTable(http_get("http://localhost:8092/data?month=" + month));

        var options = {
          title: 'June 2016',
          //curveType: 'function',
		  hAxis:{title:'day'},
		  vAxis:{title:'temperature'},
          legend: { position: 'bottom' }
        };

        var chart = new google.visualization.LineChart(document.getElementById('curve_chart'));

        chart.draw(data, options);
      }
    </script>
  </head>
  <body>
    <div id="curve_chart" style="width: 900px; height: 500px"></div>
  </body>
</html>